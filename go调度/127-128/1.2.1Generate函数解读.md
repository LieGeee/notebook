### Service ç”Ÿæˆé€»è¾‘è§£æ



```Go
func (s *shortLinkService) Generate(ctx context.Context, tenantID, userID int64, expireHours int) (*ShortLinkResponse, error) {
    // 1. ç”Ÿæˆéšæœºç 
    code, err := generateCode(8) 
    if err != nil {
        return nil, fmt.Errorf("ç”ŸæˆçŸ­ç å¤±è´¥: %w", err)
    }

    // 2. æ—¶é—´ç±»å‹è½¬æ¢ä¸è®¡ç®— (é‡ç‚¹)
    expireAt := time.Now().Add(time.Duration(expireHours) * time.Hour)

    // 3. åŠ¨æ€å­—ç¬¦ä¸²æ‹¼æ¥
    targetURL := fmt.Sprintf("%s/personnel/profile/%d", s.baseURL, userID)

    // 4. ç»„è£…æ•°æ®æ¨¡å‹
    link := &model.ShortLink{
        TenantID:  tenantID,
        UserID:    userID,
        Code:      code,
        TargetURL: targetURL,
        ExpireAt:  expireAt,
    }

    // 5. è°ƒç”¨ Repository è½åœ°
    if err := s.repo.Create(ctx, link); err != nil {
        return nil, fmt.Errorf("ä¿å­˜çŸ­é“¾å¤±è´¥: %w", err)
    }

    // 6. æ„é€ è¿”å›å¯¹è±¡
    return &ShortLinkResponse{
        Code:     code,
        ShortURL: fmt.Sprintf("%s/s/%s", s.baseURL, code),
        ExpireAt: expireAt,
    }, nil
}
```

#### 1. `generateCode(8)`

- **å«ä¹‰**ï¼šè°ƒç”¨å†…éƒ¨å·¥å…·å‡½æ•°ç”Ÿæˆä¸€ä¸ª 8 ä½é•¿åº¦çš„éšæœºå­—ç¬¦ä¸²ï¼ˆå¦‚ `aB12c3De`ï¼‰ã€‚
    
- **ç¬”è®°**ï¼šè¿™é‡Œè¿”å›äº† `err`ï¼Œæ˜¯å› ä¸ºç”Ÿæˆéšæœºæ•°å¯èƒ½å› ä¸ºç³»ç»Ÿç†µä¸è¶³ç­‰æç½•è§åŸå› å¤±è´¥ã€‚ä½¿ç”¨ `%w` åŒ…è£…é”™è¯¯æ˜¯ä¸ºäº†ä¿ç•™åŸå§‹é”™è¯¯ä¿¡æ¯ã€‚
    

#### 2. `time.Duration(expireHours) * time.Hour` (å¿…è€ƒç‚¹)

- **å«ä¹‰**ï¼šå°† `int` ç±»å‹çš„æ•´æ•°è½¬æ¢ä¸º Go çš„æ—¶é—´é—´éš”å•ä½ã€‚
    
- **æ ¸å¿ƒåŸå› **ï¼šGo æ˜¯å¼ºç±»å‹è¯­è¨€ã€‚`expireHours` æ˜¯æ•°å­—ï¼Œè€Œ `time.Hour` æ˜¯ `time.Duration` ç±»å‹ã€‚**ä¸¤è€…ä¸èƒ½ç›´æ¥ç›¸ä¹˜**ï¼Œå¿…é¡»å¼ºè½¬ã€‚
    

#### 3. `fmt.Sprintf` çš„å¦™ç”¨

- **å«ä¹‰**ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚
    
- **`targetURL`**ï¼šæ‹¼å‡ºå‘˜å·¥æ¡£æ¡ˆçš„çœŸå®é•¿é“¾æ¥ã€‚
    
- **`ShortURL`**ï¼šæ‹¼å‡ºå¯¹å¤–åˆ†äº«çš„çŸ­é“¾æ¥ã€‚
    

#### 4. `s.repo.Create(ctx, link)`

- **å«ä¹‰**ï¼šService å±‚ä¸å†™ SQLï¼Œå®ƒåªç®¡æŠŠç»„è£…å¥½çš„ `link` æ‰”ç»™ Repo å±‚ã€‚
    
- **ä¾èµ–å€’ç½®**ï¼šåªè¦ Repo å®ç°äº†æ¥å£ï¼ŒService å°±ä¸ç®¡å®ƒæ˜¯æ€ä¹ˆå­˜çš„ï¼ˆå­˜ MySQL è¿˜æ˜¯å­˜ Redis éƒ½è¡Œï¼‰ã€‚
    

---

### ğŸ“ éšå ‚æµ‹éªŒ (æ»¡åˆ† 100 åˆ†)

#### ä¸€ã€é€‰æ‹©é¢˜ (æ¯é¢˜ 25 åˆ†)

**1. ä¸ºä»€ä¹ˆåœ¨è®¡ç®— `expireAt` æ—¶è¦å†™ `time.Duration(expireHours)`ï¼Ÿ**

- A. è¿™æ˜¯ä¸€ä¸ªå›ºå®šå†™æ³•ï¼Œæ²¡æœ‰åŸå› 
    
- B. Go ä¸å…è®¸ `int` å’Œ `time.Duration` ç›´æ¥è¿ç®—ï¼Œå¿…é¡»å¼ºåˆ¶ç±»å‹è½¬æ¢
    
- C. ä¸ºäº†è®©æ—¶é—´è¿è¡Œå¾—æ›´ç²¾ç¡®
    
- D. ä¸ºäº†æŠŠå°æ—¶è½¬æ¢æˆç§’
    

**2. `fmt.Errorf("...: %w", err)` ä¸­çš„ `%w` çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Ÿ**

- A. ä»…ä»…æ˜¯ä¸ºäº†æ‰“å°é”™è¯¯
    
- B. ä¸ºäº†å°†é”™è¯¯è½¬åŒ–ä¸ºå­—ç¬¦ä¸²
    
- C. é”™è¯¯åŒ…è£…ï¼ˆWrappingï¼‰ï¼Œè®©è°ƒç”¨è€…å¯ä»¥è¿½æº¯åˆ°æœ€åº•å±‚çš„åŸå§‹é”™è¯¯
    
- D. ä¸ºäº†è®©é”™è¯¯æ˜¾ç¤ºä¸ºçº¢è‰²
    

#### äºŒã€ä»£ç æ‰¾èŒ¬ (æ¯é¢˜ 25 åˆ†)

**3. ä¸‹é¢è¿™æ®µä»£ç å¦‚æœ `s.baseURL` ä¸ºç©ºï¼Œä¼šäº§ç”Ÿä»€ä¹ˆåæœï¼Ÿ**

Go

```
ShortURL: fmt.Sprintf("%s/s/%s", s.baseURL, code)
```

- **ç­”æ¡ˆé€‰é¡¹**ï¼š
    
    - A. ç¨‹åºå´©æºƒ
        
    - B. æ¥å£è¿”å›é”™è¯¯
        
    - C. ç”Ÿæˆçš„çŸ­é“¾ä¼šå˜æˆç±»ä¼¼ `/s/ABC12345`ï¼Œå¯¼è‡´ç”¨æˆ·æ— æ³•æ­£å¸¸è®¿é—®å®Œæ•´ç½‘å€
        

**4. è¡¥å…¨ä»£ç ï¼š** å¦‚ä½•å°† `userID` (int64) æ ¼å¼åŒ–è¿›è·¯å¾„ä¸­ï¼Ÿ

Go

```
targetURL := fmt.Sprintf("/user/profile/___", userID)
```

- **ç­”æ¡ˆé€‰é¡¹**ï¼š
    
    - A. `%s`
        
    - B. `%d`
        
    - C. `%v`
        
    - D. B å’Œ C éƒ½å¯ä»¥ï¼Œä½†é’ˆå¯¹æ•´æ•° `%d` æ›´ä¸¥è°¨